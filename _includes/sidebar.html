<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="{{ '/' | relative_url }}" id="avatar" class="rounded-circle">
      {% if site.avatar != empty and site.avatar != nil %}
        {% assign avatar = site.avatar %}
        {% unless avatar contains '//' %}
          {% assign avatar = avatar | relative_url %}
        {% endunless %}
        <img src="{{ avatar }}" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      {% endif %}
    </a>

    <h1 class="site-title">
      <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">{{ site.tagline }}</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0 overflow-auto">
    <div class="px-4 pb-3">
        <h5 class="text-uppercase small text-muted mb-3">Index</h5>
        
        {% assign current_year = "" %}
        {% for post in site.posts %}
            {% assign post_year = post.date | date: "%Y" %}
            {% if post_year != current_year %}
                {% if current_year != "" %}
                    </div> <!-- close previous year div -->
                {% endif %}
                
                <h6 class="text-muted mt-3 mb-2 small font-weight-bold" style="cursor: pointer;" data-bs-toggle="collapse" data-bs-target="#year-{{ post_year }}" aria-expanded="false" aria-controls="year-{{ post_year }}">
                    <i class="fas fa-angle-right me-1 transition-transform"></i>{{ post_year }}
                </h6>
                <div class="collapse" id="year-{{ post_year }}">
                {% assign current_year = post_year %}
            {% endif %}
            
            <div class="mb-2 lh-sm ps-3">
                <a href="{{ post.url | relative_url }}" class="text-decoration-none text-reset d-block">
                    <span class="text-muted small">{{ post.date | date: "%m-%d" }}</span>
                    <span class="d-block text-truncate">{{ post.title }}</span>
                </a>
            </div>
        {% endfor %}
        {% if current_year != "" %}
            </div> <!-- close last year div -->
        {% endif %}
    </div>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    {% unless site.theme_mode %}
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      {% if site.data.contact %}
        <span class="icon-border"></span>
      {% endif %}
    {% endunless %}

    {% for entry in site.data.contact %}
      {% capture url %}
        {%- if entry.type == 'github' -%}
          https://github.com/{{ site.github.username }}
        {%- elsif entry.type == 'twitter' -%}
          https://twitter.com/{{ site.twitter.username }}
        {%- elsif entry.type == 'email' -%}
          {% assign email = site.social.email | split: '@' %}
          javascript:location.href = 'mailto:' + ['{{ email[0] }}','{{ email[1] }}'].join('@')
        {%- elsif entry.type == 'rss' -%}
          {{ "/feed.xml" | relative_url }}
        {%- else -%}
          {{ entry.url }}
        {%- endif -%}
      {% endcapture %}

      {% if url %}
        <a href="{{ url }}" aria-label="{{ entry.type }}"
          {% unless entry.noblank %} target="_blank" rel="noopener noreferrer"{% endunless %}>
          <i class="{{ entry.icon }}"></i>
        </a>
      {% endif %}
    {% endfor %}
  </div>
  <!-- .sidebar-bottom -->
</aside>
